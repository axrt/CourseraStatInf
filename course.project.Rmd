---
title: 'Statistical Inference: The Study of the Exponential Distribution, A Simulation
  Exercise'
author: "Alexander Tuzhikov"
date: "September 14, 2015"
fontsize: 9pt
documentclass: article
mainfont: HelveticaNeue
output:
  pdf_document:
    highlight: haddock
    keep_tex: yes
    latex_engine: xelatex
    number_sections: yes
    toc: yes
    
  html_document:
    fig_caption: yes
    fig_height: 9
    fig_width: 12
    highlight: haddock
    keep_md: yes
    number_sections: yes
    theme: cosmo
    toc: yes
---

```{r libraries, echo=FALSE, results='hide', warning=FALSE, message=FALSE}
library(dplyr)
library(ggplot2)
library(reshape2)
```

#Overview: Exponential Distribution

In accordance with [Wikipedia](https://en.wikipedia.org/wiki/Exponential_distribution), **e**xponential **d**istribution (ED) *is the probability distribution that describes the time between events in a Poisson process, i.e. a process in which events occur continuously and independently at a constant average rate.* Both *mean* and *standard deviation* of the ED is *1/lambda*. As suggested in the study objective, here we will use lambda = 0.2. However, for the purpose of introduction, let's reconstruct the wiki plots of the ED with different lambda:

```{r Overview 1, warning=FALSE}
lambdas<- c(0.2, 0.5, 1, 1.5)#the given in the task + those from wikipedia
n<- 40 #given by ".. you will investigate the distribution of 
       #averages of 40 exponential(0.2)s" in the task
sampling.count<- 1000  #given by ".. you will need to do a 
       #thousand or so simulated averages of 40 exponentials" in the task
set.seed(2015) #seed for reproducibility
ed.mean<- mean(rexp(1e6, 0.2))
ed.sd<- sd(rexp(1e6, 0.2))
all.equal(ed.mean, ed.sd, tolerance = 1e-2) #mean and standard deviation are equal up to 1e-2 level of prescision
#prepare a data.frame for the plot, melt by x, plot as line
ed.plot.df<- as.data.frame(cbind(
        x=0:40,
        la.0.2=dexp(x=0:40, lambdas[1]),
        la.0.5=dexp(x=0:40, lambdas[2]),
        la.1=dexp(x=0:40, lambdas[3]),
        la.1.5=dexp(x=0:40, lambdas[4])
)) %>% 
        melt(id.vars="x") %>%
        ggplot(data=., mapping=aes(x=x, group=variable, y=value, color=variable)) + 
        geom_line(size=2) + theme_bw() + xlim(0,20) + ylim(0,1) +
        labs(title="ED Probability Density Function") + ylab("Probability") +
        scale_color_manual(values=rainbow(4, start = 0.3, end = 0.9), labels=c("0.2","0.5", "1.0", "1.5"), name="Lambda")
plot(ed.plot.df)
```

We just checked if the mean and the standard deviation are equal and plotted the probability density function at different levels of lambda.

#Simulations: Sampling the ED

Now, let's move to the first task:  
*1. Show the sample mean and compare it to the theoretical mean of the distribution.* First we gonna need `r sampling.count` samples of size `r n` form ED.

```{r simulation 1}
#sampling
samples<- as.data.frame(do.call(what = "cbind", args = lapply(1:sampling.count, function(x){return(rexp(n, lambdas[1]))})))
samples.colMeans<- colMeans(samples) #calculate the column means
```

Ok, now let's compare the theoretical mean, which is:

```{r simulation 2}
1/lambdas[1]
```

to that of the simulation procedure:

```{r simulation 3}
mean(samples.colMeans) #calculate the total mean
#compare
all.equal(1/lambdas[1],mean(samples.colMeans))
```

The difference is neglegible in our case.

#Sample Mean versus Theoretical Mean

#Sample Variance versus Theoretical Variance

#Distribution